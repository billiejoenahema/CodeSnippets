以下の内容のCSVを編集するプログラムをPHPで作成したいです。

編集したいCSVの内容です。
このCSVのファイルパスは './concatenated.csv' です。

1,a,あ,,20230101,,
1,w,か,,20230201,,
1,q,さ,,20230301,,
2,p,ざ,,20230112,,
2,o,じ,,20230122,,
2,i,ず,,20230212,,
3,c,う,,20230103,,
3,c,う,,20230103,,
3,c,う,,20230103,,
2,v,は,,20240112,,
2,n,ひ,,20240122,,
4,d,え,,20230104,,
4,d,え,,20230104,,
4,d,え,,20230104,,

このCSVをもとに新しいCSVを作成します。
新しいCSVのファイル名は 'concatenated_[現在時刻].csv' としてください。
[現在時刻]にはyyyymmddhhiiss形式の現在時刻の数値が入ります。

同じ1列目の値が連続している行のまとまりをグループと定義します。
このCSVの場合、グループ数は5です。
1列目の値が1であるグループ
1列目の値が2であるグループ
1列目の値が3であるグループ
1列目の値が4であるグループ
1列目の値が5であるグループ

たとえば、
1,a,あ,,20230101,,
1,w,か,,20230201,,
1,q,さ,,20230301,,
は同じ1列目の値が連続しているのでこの3行で1グループと考えます。

空の配列にグループ単位で追加していきます。

ただし、追加しようとしているグループの1行目の1列目の値と同じ値が配列要素の中の1列目の中に含まれていたら、そのグループは新しいCSVには追加しません。

これにより作成される配列は以下となるはずです。
[
    [1,a,あ,,20230101,,],
    [1,w,か,,20230201,,],
    [1,q,さ,,20230301,,],
    [2,p,ざ,,20230112,,],
    [2,o,じ,,20230122,,],
    [3,c,う,,20230103,,],
    [3,c,う,,20230103,,],
    [3,c,う,,20230103,,],
    [4,d,え,,20230104,,],
    [4,d,え,,20230104,,],
    [4,d,え,,20230104,,],
]
この配列の要素を新しいCSVに追加していきます。

新しいCSVの内容は以下となるのが正解です。
1,a,あ,,20230101,,
1,w,か,,20230201,,
1,q,さ,,20230301,,
2,p,ざ,,20230112,,
2,o,じ,,20230122,,
3,c,う,,20230103,,
3,c,う,,20230103,,
3,c,う,,20230103,,
4,d,え,,20230104,,
4,d,え,,20230104,,
4,d,え,,20230104,,
