Sub ChangeValuesInSheets()
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim filePath As String

    ' ターゲットとなるエクセルファイルのパス
    filePath = ThisWorkbook.Path & "\target_file.xlsx"
    ' value1, value2, replacedValue を置き換える

    ' ターゲットファイルが存在するかチェック
    If Dir(filePath) = "" Then
        MsgBox "ターゲットファイル「" & filePath & "」が見つかりません。", vbExclamation
        Exit Sub
    End If

    ' ターゲットファイルを開く
    Set wb = Workbooks.Open(filePath)

    ' ワークブック内の各シートに対してループ
    For Each ws In wb.Sheets
        ' シートのデータの最終行を取得
        Dim lastRow As Long
        lastRow = ws.Cells(ws.Rows.Count, "B").End(xlUp).Row

        ' 各行に対してループ
        Dim i As Long
        For i = 1 To lastRow
            ' B列が「value1」かつC列が「value2」の場合
            If ws.Cells(i, "B").Value = "value1" And ws.Cells(i, "C").Value = "value2" Then
                ' C列の値を「replacedValue」に変更
                ws.Cells(i, "C").Value = "replacedValue"
            End If
        Next i
    Next ws

    ' ターゲットファイルを保存して閉じる
    wb.Save
    wb.Close

    ' 置換処理が終了したことをユーザーに知らせる
    MsgBox "置換処理が正常に終了しました。", vbInformation

    ' ターゲットファイルを再度開く
    Workbooks.Open (filePath)
End sub
